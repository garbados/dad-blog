<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>W O R D S</title>

  <link rel="stylesheet" href="static/style.css">
</head>
<body>
  <section class="section">
    <div class="container">
      <div class="columns">
        <div class="column is-one-fifth">
          <p class="title"><a href="index.html">W O R D S</a></p>
          <p class="subtitle">Essays, etc.</p>
          <hr>
          <figure class="image" alt="A picture of me.">
            <img src="static/self.jpg">
          </figure>
          <p class="content">
            <p>My name is Diana. I make things but generally not very well. I put thoughts here.</p>
          </p>
          <hr>
          <aside class="menu">
            <p class="menu-label">Me, elsewhere:</p>
            <ul>
              <li>
                <a href="https://toot.cat/@garbados">Mastodon</a>
              </li>
              <li>
                <a href="https://github.com/garbados">GitHub</a>
              </li>
            </ul>
          </aside>
        </div>
        <div class="column">
              <div class="box">
                <p>
                  <a href="index.html"><i class="fa fa-home" aria-hidden="true"></i></a>
                  &gt;
                  <a href="p2p-and-cap.html">Peer-to-Peer Datastructures and the CAP Theorem</a>
                </p>
                <hr>
                <div class="content">
                  <h1 id="peer-to-peer-datastructures-and-the-cap-theorem">Peer-to-Peer Datastructures and the CAP Theorem</h1>
          <p>Are you familiar with the <a href="https://en.wikipedia.org/wiki/CAP_theorem">CAP theorem</a>? It says a distributed store of data may satisfy at most two of the three following guarantees:</p>
          <ul>
          <li>Consistency: Every request for data receives the most recent version of that data (or an error). (not to be confused with consistency in <a href="https://en.wikipedia.org/wiki/Database_transaction">ACID</a>)</li>
          <li>Availability: Every request receives a (non-error) response â€“ without guarantee that it contains the most recent version.</li>
          <li>Partition tolerance: The system continues to operate even when members disagree about data, or cannot reliably reach each other.</li>
          </ul>
          <p>These properties normally come up in the context of distributed databases like <a href="https://couchdb.apache.org/">CouchDB</a> or SQL clusters, but it&#39;s not hard to argue that peer-to-peer systems like <a href="https://en.wikipedia.org/wiki/BitTorrent">BitTorrent</a> and <a href="https://datproject.org/">Dat</a> are also distributed stores of data. Is it possible to describe a protocol like <a href="https://ipfs.io/">IPFS</a> as consistent, available, or partition tolerant?</p>
          <p>I want to try.</p>
          <h2 id="ipfs">IPFS</h2>
          <p>I would describe IPFS as consistent, available, and partition tolerant. No, I am not joking.</p>
          <p>Content in IPFS is immutable. It is hash-addressed, so modifying the content would modify the hash. If a peer requests the contents of a particular hash and a peer responds with contents with do not reflect the hash, the response is ignored. The data is self-proving.</p>
          <p>As a result, the only version of a piece of data is its latest version. Any changes would have to be shared under a different hash, because the content would hash differently. This makes data in IPFS highly consistent: while any peer in the network has the data, any request for that data will receive the latest version.</p>
          <p>If peers become cut off and no member of a partition of the network has the data, the data becomes unavailable, but the system does not fail. Once the partition heals <em>or</em> data matching that hash is uploaded independently, it will become available again. This makes IPFS both available (because every request gets a response) and partition tolerant (because partitions can operate independently and heal from arbitrary segmentation).</p>
          <h2 id="-what-"><em>What?</em></h2>
          <p>If IPFS satisfies the consistency, availability, <em>and</em> partition tolerance, then what use is the CAP theorem to us as a description of the limits of distributed data stores?</p>
          <p>I don&#39;t know. But, some peer-to-peer systems do not satisfy all three guarantees.</p>
          <h2 id="dat">Dat</h2>
          <p>I would describe Dat as satisfying availability, but neither consistency nor partition tolerance, and still it is a vitally important technology.</p>
          <p>Content in Dat, aka an &quot;archive&quot;, is addressed by a hash of the public key of the keypair used to write it. This makes archives mutable and builds into them a notion of ownership, as only those who control the keypair can modify the archive, but anyone can share it. That makes it available: while any peer in the network is sharing the archive of a particular pubkey, requests for that archive will receive a version of it.</p>
          <p>But because of the archive&#39;s mutability, peers are constantly exchanging revisions and may not themselves always have the latest version. Requests for data from a peer who is still catching up may return a stale version. As a result, even outside of a partition, the network is not highly consistent.</p>
          <p>What happens when you lose the keypair to an archive, or destroy it? Until someone brute-forces your privkey, the archive is effectively immutable. To share the content, you would have to do so under a new keypair.</p>
          <p>What happens when someone acquires your keypair? An attacker with the keypair for an archive can modify it in ways that the network cannot distinguish as illegitimate, and I haven&#39;t found a description of how the network would deal with these conflicts. What happens when two conflicting append-only logs share the same address? Until I find out, it&#39;s hard to argue the system is partition tolerant.</p>
          <p>And still, Dat archives are like mutable torrents. That makes broad classes of peer-to-peer software possible which use Dat archives for storage and distribution. Baking a notion of ownership into the data is a powerful pattern that comes up again and again, but it creates the possibility for irresolveable claims to authority over content, and the reality that peers can only ever play catch-up to the peer(s) with the keypair.</p>
          <h2 id="ssb">SSB</h2>
          <p>TODO</p>
          <h2 id="blockchains">Blockchains</h2>
          <p>TODO</p>
                </div>
                <hr>
                <p><small><em>Thu Nov 23 2017 11:32:21 GMT-0800 (PST)</em></small></p>
              </div>
        </div>
      </div>
    </div>
  </section>
</body>
</html>